    /**
     * Convenience method for creating a weblog category.
     */
    public static WeblogCategory setupWeblogCategory(Weblog weblog,
                                                         String name,
                                                         WeblogCategory parent)
            throws Exception {
        
        WeblogManager mgr = WebloggerFactory.getWeblogger().getWeblogManager();
        WeblogCategory root = mgr.getRootWeblogCategory(weblog);
        
        WeblogCategory catParent = root;
        if(parent != null) {
            catParent = parent;
        }
        WeblogCategory testCat = new WeblogCategory(weblog, catParent, name, null, null);
        mgr.saveWeblogCategory(testCat);
        
        // flush to db
        WebloggerFactory.getWeblogger().flush();
        
        // query for object
        WeblogCategory cat = mgr.getWeblogCategory(testCat.getId());
        
        if(cat == null)
            throw new WebloggerException("error setting up weblog category");
        
        return cat;
    }

