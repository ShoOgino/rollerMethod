    public Template handleRequest( HttpServletRequest request,                                   HttpServletResponse response,                                   Context ctx ) throws Exception    {        String pid = null;        Template outty = null;        Exception pageException = null;                try        {            PageContext pageContext =                JspFactory.getDefaultFactory().getPageContext(                    this, request, response,"", true, 8192, true);            // Needed to init request attributes, etc.            RollerRequest rreq = RollerRequest.getRollerRequest(pageContext);            UserManager userMgr = rreq.getRoller().getUserManager();                        WebsiteData wd = null;            if (request.getAttribute(RollerRequest.OWNING_USER) != null) {                UserData user = (UserData)                    request.getAttribute(RollerRequest.OWNING_USER);                wd = userMgr.getWebsite(user.getUserName());            }            else            {                wd = rreq.getWebsite();            }                        // If request specified the page, then go with that            WeblogTemplate pd = null;            if (rreq.getPage() != null // RollerRequest does too much guess work                    && request.getAttribute(RollerRequest.OWNING_USER) == null)            {                pd = rreq.getPage();                pid = pd.getId();            }            // If page not available from request, then use website's default            else if (wd != null)            {                pd = userMgr.retrievePage(wd.getDefaultPageId());                pid = pd.getId();                rreq.setPage(pd);             }            // Still no page ID, then we have a problem            if ( pid == null )            {                throw new ResourceNotFoundException("Page not found");            }                        outty = prepareForPageExecution(ctx, rreq, response, pd);        }        catch( Exception e )        {	        pageException = e;            response.setStatus( HttpServletResponse.SC_INTERNAL_SERVER_ERROR);        }        if (pageException != null)        {            mLogger.error("EXCEPTION: in RollerServlet", pageException);            request.setAttribute("DisplayException", pageException);        }        return outty;    }
