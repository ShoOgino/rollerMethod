    /**
     * Called to shutdown the background thread, and flush the RAM index
     * to disk if necessary.
     */
    public void dispose()
    {
        if (useRAMIndex)
        {
            scheduleIndexOperation(getSaveIndexOperation());
        }
        else
        {
            indexConsistencyMarker.delete();
        }
	
        try {
			if (reader!=null)
				reader.close();
		} catch (IOException e) {
			// won't happen, since it was
		}
    }

