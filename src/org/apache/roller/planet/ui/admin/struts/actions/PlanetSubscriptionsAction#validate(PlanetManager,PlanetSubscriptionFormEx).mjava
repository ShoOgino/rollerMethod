    /** Validate posted subscription, fill in blanks via Technorati */
    private ActionErrors validate(
            PlanetManager pmgr, PlanetSubscriptionFormEx form) {
        String technoratiTitle = null;
        String technoratiFeedUrl = null;
        int inboundlinks = -1;
        int inboundblogs = -1;
        if (form.getSiteURL()!=null && form.getSiteURL().trim().length() > 0) {
            try {
                PropertiesManager props = PlanetFactory.getPlanet().getPropertiesManager();
                Technorati technorati = null;
                PropertyData proxyHostProp = props.getProperty("proxyHost");
                PropertyData proxyPortProp = props.getProperty("proxyPort");
                if (proxyHostProp != null && proxyPortProp != null) {
                    technorati = new Technorati(proxyHostProp.getValue(), Integer.parseInt(proxyPortProp.getValue())); 
                } else {
                    technorati = new Technorati();
                }
                Technorati.Result result =
                        technorati.getBloginfo(form.getSiteURL());
                technoratiTitle = result.getWeblog().getName();
                technoratiFeedUrl = result.getWeblog().getRssurl();
                form.setInboundlinks(result.getWeblog().getInboundlinks());
                form.setInboundblogs(result.getWeblog().getInboundblogs());
            } catch (Exception e) {
                logger.debug("Unable to contact Technorati", e);
            }
        }
        
        ActionErrors errors = new ActionErrors();
        if (form.getTitle()==null || form.getTitle().trim().length()==0) {
            if (technoratiTitle!=null && technoratiTitle.trim().length()>0) {
                form.setTitle(technoratiTitle);
            } else {
                errors.add(null,
                        new ActionError("planetSubscription.error.title"));
            }
        }
        if (form.getFeedURL()==null || form.getFeedURL().trim().length()==0) {
            if (technoratiFeedUrl!=null && technoratiFeedUrl.trim().length()>0) {
                form.setFeedURL(technoratiFeedUrl);
            } else {
                errors.add(null,
                        new ActionError("planetSubscription.error.feedUrl"));
            }
        }
        if (form.getSiteURL()==null || form.getSiteURL().trim().length()==0) {
            errors.add(null,
                    new ActionError("planetSubscription.error.siteUrl"));
        }
        return errors;
    }

