    public boolean isUserAuthenticated() {
        return (request.getUserPrincipal() != null);
    }

