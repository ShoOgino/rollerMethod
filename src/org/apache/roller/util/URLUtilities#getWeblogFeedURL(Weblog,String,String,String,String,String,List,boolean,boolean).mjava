    /**
     * Get url for a feed on a given weblog.
     */
    public static final String getWeblogFeedURL(Weblog weblog,
                                                String locale,
                                                String type,
                                                String format,
                                                String category,
                                                String term,
                                                List tags,
                                                boolean excerpts,
                                                boolean absolute) {
        
        if(weblog == null) {
            return null;
        }
        
        StringBuffer url = new StringBuffer();
        
        url.append(getWeblogURL(weblog, locale, absolute));
        url.append("feed/").append(type).append("/").append(format);
        
        Map params = new HashMap();
        if(category != null && category.trim().length() > 0) {
            params.put("cat", encode(category));
        }
        if(tags != null && tags.size() > 0) {
          params.put("tags", getEncodedTagsString(tags));
        }
        if(term != null && term.trim().length() > 0) {
            params.put("q", encode(term.trim()));
        }
        if(excerpts) {
            params.put("excerpts", "true");
        }
        
        return url.toString() + getQueryString(params);
    }

