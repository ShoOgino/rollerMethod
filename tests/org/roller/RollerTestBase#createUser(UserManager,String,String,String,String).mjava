    //-----------------------------------------------------------------------
    protected UserData createUser(
                    UserManager umgr,
                    String username,
                    String password,
                    String fullName,
                    String email) throws RollerException
    {
        UserData ud = new UserData(null,
            username,         // userName
            password,           // password
            fullName,      // fullName
            email, // emailAddress
            new java.util.Date()  // dateCreated
            );
        Map pages = new HashMap();
        pages.put("Weblog","Weblog page content");
        pages.put("_day","Day page content");
        pages.put("css","CSS page content");
        umgr.addUser(ud, pages, Theme.CUSTOM, "en_US_WIN", "America/Los_Angeles");
        
        // the addUser method no longer creates pages, so we add them manually
        WebsiteData website = umgr.getWebsite(username);
        Iterator iter = pages.keySet().iterator();
        while ( iter.hasNext() )
        {
            String pageName = (String) iter.next();
            String sb = (String)pages.get( pageName );
              
            // Store each Velocity template as a page
            WeblogTemplate pd = new WeblogTemplate( null,
                website,         // website
                pageName,        // name
                pageName,        // description
                pageName,        // link
                sb,              // template
                new Date()       // updateTime                
            );
            umgr.storePage(pd);
            
            if ( pd.getName().equals("Weblog") )
            {  
                website.setDefaultPageId(pd.getId());                 
            }
            else if ( pd.getName().equals("_day") )
            {
                website.setWeblogDayPageId(pd.getId());                 
            }                
        }
        website.save();
        
        return ud;
    }

