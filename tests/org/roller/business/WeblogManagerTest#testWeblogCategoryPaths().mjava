    public void testWeblogCategoryPaths() throws Exception
    {
        WebsiteData wd = null;
        WeblogCategoryData root = null;
        WeblogManager wmgr = getRoller().getWeblogManager();
        
        getRoller().begin(UserData.SYSTEM_USER);
        
        wd = getRoller().getUserManager().retrieveWebsite(mWebsite.getId());
        root = wmgr.getRootWeblogCategory(wd);

        WeblogCategoryData f1 = wmgr.createWeblogCategory();
        f1.setName("f1");
        f1.setParent(root);
        f1.setWebsite(wd);
        f1.save();
        
        WeblogCategoryData f2 = wmgr.createWeblogCategory(); 
        f2.setName("f2");
        f2.setParent(f1);
        f2.setWebsite(wd);
        f2.save();
      
        WeblogCategoryData f3 = wmgr.createWeblogCategory(); 
        f3.setName("f3");
        f3.setParent(f2);
        f3.setWebsite(wd);
        f3.save();
        
        getRoller().commit();
        
        getRoller().begin(UserData.SYSTEM_USER);
        
        // check count of descendents and ancestors
        f1 = wmgr.retrieveWeblogCategory(f1.getId());        
        assertEquals(2, f1.getAllDescendentAssocs().size());
        assertEquals(1, f1.getAncestorAssocs().size());
        
        f2 = wmgr.retrieveWeblogCategory(f2.getId());        
        assertEquals(1, f2.getAllDescendentAssocs().size());
        assertEquals(2, f2.getAncestorAssocs().size());
        
        f3 = wmgr.retrieveWeblogCategory(f3.getId());        
        assertEquals(0, f3.getAllDescendentAssocs().size());
        assertEquals(3, f3.getAncestorAssocs().size());
        
        // test get by path
        assertEquals("f1", 
            wmgr.getWeblogCategoryByPath(wd, null, "f1").getName());
        
        assertEquals("f1", 
            wmgr.getWeblogCategoryByPath(wd, null, "/f1").getName());
        
        assertEquals("f2", 
            wmgr.getWeblogCategoryByPath(wd, null, "/f1/f2").getName());
        
        assertEquals("f3", 
            wmgr.getWeblogCategoryByPath(wd, null, "/f1/f2/f3").getName());
        
        // test path creation
        f3 = wmgr.getWeblogCategoryByPath(wd, null, "/f1/f2/f3");
        String pathString = wmgr.getPath(f3);
        String[] pathArray = Utilities.stringToStringArray(pathString,"/");
        assertEquals("f1", pathArray[0]);
        assertEquals("f2", pathArray[1]);
        assertEquals("f3", pathArray[2]);
        
        getRoller().commit();
    }    

