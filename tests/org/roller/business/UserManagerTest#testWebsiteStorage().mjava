    //------------------------------------------------------------------------
    /** Tests storage and removal of website. */
    public void testWebsiteStorage() throws RollerException
    {
        UserData user = null;
        WebsiteData stored = null;
        UserManager umgr = getRoller().getUserManager();

        getRoller().begin(UserData.SYSTEM_USER);

        user = new UserData(
            null,
            "testWebsiteStorage3",
            "password3",
            "TestUser3",
            "testuser3@example.com",
            "en_US_WIN", "America/Los_Angeles",
            new java.util.Date(), Boolean.TRUE);
        umgr.storeUser(user);
        
        stored = new WebsiteData();
        stored.setName("testsite3");
        stored.setHandle("testsite3");
        stored.setDescription("Testsite3");
        stored.setCreator(user);
        stored.setDefaultPageId("dpid");
        stored.setWeblogDayPageId("ddid");
        stored.setEnableBloggerApi(Boolean.FALSE);
        stored.setEditorPage("edit-weblog.jsp");
        stored.setAllowComments(Boolean.TRUE);
        stored.setEmailComments(Boolean.FALSE);
        stored.setEmailAddress("test@test.com");
        stored.setEnabled(Boolean.TRUE);
        stored.setEditorTheme("theme");
        stored.setDateCreated(new Date());
        stored.setBlacklist("ignore");
        stored.setDefaultAllowComments(Boolean.TRUE);
        stored.setDefaultCommentDays(7);
        stored.setModerateComments(Boolean.FALSE);
        umgr.storeWebsite(stored);
        
        WeblogCategoryData rootCategory = getRoller().getWeblogManager()
            .createWeblogCategory(stored, null, "root", "root", "");
        rootCategory.save();

        stored.setBloggerCategory(rootCategory);
        stored.setDefaultCategory(rootCategory);
        
        FolderData rootFolder = getRoller().getBookmarkManager()
            .createFolder(null, "root", "root", stored);
        rootFolder.save();

        getRoller().commit();

        getRoller().begin(UserData.SYSTEM_USER);
        WebsiteData retrieved = umgr.retrieveWebsite(stored.getId());
        assertEquals(stored, retrieved);
        retrieved.remove();
        getRoller().commit();

        getRoller().begin(UserData.SYSTEM_USER);
        user = umgr.retrieveUser(user.getId());
        user.remove();
        getRoller().commit();

        getRoller().begin(UserData.SYSTEM_USER);
        assertNull(umgr.retrieveUser(user.getId()));
        assertNull(umgr.retrieveWebsite(stored.getId()));
        getRoller().rollback();
    }

