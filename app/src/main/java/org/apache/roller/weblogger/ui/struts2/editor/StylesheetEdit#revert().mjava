    /**
     * Revert the stylesheet to its original state.
     */
    public String revert() {

        if (getTemplate() == null) {
            addError("stylesheetEdit.error.cannotFind");
            return ERROR;
        }

        // make sure we are still using a shared theme so that reverting is
        // possible
        if (WeblogTheme.CUSTOM.equals(getActionWeblog().getEditorTheme())) {
            addError("stylesheetEdit.error.customTheme");
        }

        if (!hasActionErrors()) {
            try {

                WeblogTemplate stylesheet = getTemplate();

                // lookup the theme used by this weblog
                ThemeManager tmgr = WebloggerFactory.getWeblogger()
                        .getThemeManager();
                Theme theme = tmgr.getTheme(getActionWeblog().getEditorTheme());

                stylesheet.setLastModified(new Date());

                if (stylesheet.getTemplateRendition(STANDARD_THEME_TYPE) != null) {
                    TemplateRendition templateCode = theme.getStylesheet()
                            .getTemplateRendition(STANDARD_THEME_TYPE);
                    // if we have a template, then set it
                    CustomTemplateRendition existingTemplateCode = stylesheet
                            .getTemplateRendition(STANDARD_THEME_TYPE);
                    existingTemplateCode
                            .setTemplate(templateCode.getTemplate());
                    WebloggerFactory.getWeblogger().getWeblogManager()
                            .saveTemplateRendition(existingTemplateCode);

                    // TODO do we still want to set the contents here?
                    stylesheet.setContents(templateCode.getTemplate());
                }
                if (stylesheet.getTemplateRendition(MOBILE_THEME_TYPE) != null) {
                    TemplateRendition templateCode = theme.getStylesheet()
                            .getTemplateRendition(MOBILE_THEME_TYPE);
                    CustomTemplateRendition existingTemplateCode = stylesheet
                            .getTemplateRendition(MOBILE_THEME_TYPE);
                    existingTemplateCode
                            .setTemplate(templateCode.getTemplate());
                }

                // save template and flush
                WebloggerFactory.getWeblogger().getWeblogManager()
                        .savePage(stylesheet);
                WebloggerFactory.getWeblogger().flush();

                // notify caches
                CacheManager.invalidate(stylesheet);

                // success message
                addMessage("stylesheetEdit.revert.success",
                        stylesheet.getName());

            } catch (WebloggerException ex) {
                log.error("Error updating stylesheet template for weblog - "
                        + getActionWeblog().getHandle(), ex);
                addError("stylesheetEdit.revert.failure");
            }
        }

        return execute();
    }

