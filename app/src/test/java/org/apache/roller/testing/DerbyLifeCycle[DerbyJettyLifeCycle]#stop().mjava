    public void stop() throws Exception {
        log.info("**************");
        log.info("Stopping Derby");
        log.info("**************");
        stopping = true;
        try {
            System.out.println("Stopping Derby");
            System.setProperty("derby.drda.portNumber", port);
            System.setProperty("derby.drda.host", "localhost");
            NetworkServerControl server = new NetworkServerControl();
            server.shutdown();
            try {Thread.sleep(2000);} catch (Exception ignored) {}
            started = false;
            starting = false;
            stopping = false;
            failed = false;
        } catch (Exception e) {
            failed = true;
            stopping = false;
            throw new Exception("Unable to start Derby. EXCEPTION: "
                + e.getClass().getName() + " Message: " + e.getMessage());
        }
    }

