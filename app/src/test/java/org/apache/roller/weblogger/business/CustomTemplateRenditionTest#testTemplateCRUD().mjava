       /**
        * Test basic persistence operations ... Create, Update, Delete
        */
       public void testTemplateCRUD() throws Exception {

           WeblogManager mgr = WebloggerFactory.getWeblogger().getWeblogManager();


           // create template
           mgr.savePage(testPage);


           //create standard template coce
           CustomTemplateRendition standardTemplateCode = new CustomTemplateRendition(testPage.getId(), RenditionType.STANDARD);
           standardTemplateCode.setTemplate("standard.template.code");
           standardTemplateCode.setTemplateLanguage(TemplateLanguage.VELOCITY);
           mgr.saveTemplateRendition(standardTemplateCode);
            //TestUtils.endSession(true);
           //create mobile code
           CustomTemplateRendition mobileTemplateCode = new CustomTemplateRendition(testPage.getId(), RenditionType.MOBILE);
           mobileTemplateCode.setTemplate("mobile.template.code");
           mobileTemplateCode.setTemplateLanguage(TemplateLanguage.VELOCITY);
           mgr.saveTemplateRendition(mobileTemplateCode);
             TestUtils.endSession(true);


           // check that create was successful
            standardCode = mgr.getTemplateRenditionByType(testPage.getId(), RenditionType.STANDARD);
           assertNotNull(standardCode);
           assertEquals(standardTemplateCode.getTemplate() ,standardCode.getTemplate());

            mobileCode = mgr.getTemplateRenditionByType(testPage.getId(), RenditionType.MOBILE);
           assertNotNull(mobileCode);
           assertEquals(mobileTemplateCode.getTemplate() ,mobileCode.getTemplate());

           // update template Code
           standardCode = null;
           standardCode = mgr.getTemplateRenditionByType(testPage.getId(), RenditionType.STANDARD);
           standardCode.setTemplate("update.standard.template");
           mgr.saveTemplateRendition(standardCode);

           mobileCode = null;
           mobileCode = mgr.getTemplateRenditionByType(testPage.getId(), RenditionType.MOBILE);
           mobileCode.setTemplate("update.mobile.template");
           mgr.saveTemplateRendition(mobileCode);

           TestUtils.endSession(true);

           // check that update was successful
           standardCode =null;
           standardCode = mgr.getTemplateRenditionByType(testPage.getId(), RenditionType.STANDARD);
           assertEquals("update.standard.template",standardCode.getTemplate());

           mobileCode =null;
           mobileCode = mgr.getTemplateRenditionByType(testPage.getId(), RenditionType.MOBILE);
           assertEquals("update.mobile.template",mobileCode.getTemplate());

           WeblogTemplate page = mgr.getPage(testPage.getId());
           mgr.removePage(page);
           TestUtils.endSession(true);

           // check that update was successful
           standardCode =null;
           standardCode = mgr.getTemplateRenditionByType(testPage.getId(), RenditionType.STANDARD);
           assertNull(standardCode);

           mobileCode =null;
           mobileCode = mgr.getTemplateRenditionByType(testPage.getId(), RenditionType.MOBILE);
           assertNull(mobileCode);

       }

